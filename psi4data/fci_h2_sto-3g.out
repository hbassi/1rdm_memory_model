
    -----------------------------------------------------------------------
          Psi4: An Open-Source Ab Initio Electronic Structure Package
                               Psi4 1.9.1 release

                         Git: Rev {} zzzzzzz 


    D. G. A. Smith, L. A. Burns, A. C. Simmonett, R. M. Parrish,
    M. C. Schieber, R. Galvelis, P. Kraus, H. Kruse, R. Di Remigio,
    A. Alenaizan, A. M. James, S. Lehtola, J. P. Misiewicz, M. Scheurer,
    R. A. Shaw, J. B. Schriber, Y. Xie, Z. L. Glick, D. A. Sirianni,
    J. S. O'Brien, J. M. Waldrop, A. Kumar, E. G. Hohenstein,
    B. P. Pritchard, B. R. Brooks, H. F. Schaefer III, A. Yu. Sokolov,
    K. Patkowski, A. E. DePrince III, U. Bozkaya, R. A. King,
    F. A. Evangelista, J. M. Turney, T. D. Crawford, C. D. Sherrill,
    J. Chem. Phys. 152(18) 184108 (2020). https://doi.org/10.1063/5.0006002

                            Additional Code Authors
    E. T. Seidl, C. L. Janssen, E. F. Valeev, M. L. Leininger,
    J. F. Gonthier, R. M. Richard, H. R. McAlexander, M. Saitow, X. Wang,
    P. Verma, M. H. Lechner, A. Jiang, S. Behnle, A. G. Heide,
    M. F. Herbst, and D. L. Poole

             Previous Authors, Complete List of Code Contributors,
                       and Citations for Specific Modules
    https://github.com/psi4/psi4/blob/master/codemeta.json
    https://github.com/psi4/psi4/graphs/contributors
    http://psicode.org/psi4manual/master/introduction.html#citing-psifour

    -----------------------------------------------------------------------


    Psi4 started on: Saturday, 13 September 2025 05:01PM

    Process ID: 1952037
    Host:       gnode010.cluster
    PSIDATADIR: /home/hbhat/psi4conda/share/psi4
    Memory:     500.0 MiB
    Threads:    1
    
  ==> Input File <==

--------------------------------------------------------------------------
memory 1 gb

molecule h2 {
H  0.       0.      -0.37
H  0.       0.       0.37
symmetry c1
no_com
no_reorient
}

set {
    reference rhf
    basis sto-3g
    ms0 false
    fci true
    diag_method rsp
    num_roots 4
    print 2
    dipmom true
    opdm true
    tdm true
}

thisenergy, ciwfn = prop('detci', properties=['DIPOLE', 'TRANSITION_DIPOLE'], return_wfn=True)

mints = MintsHelper(ciwfn.basisset())

AOdip = mints.ao_dipole()
AOdip[0].print_out()
AOdip[1].print_out()
AOdip[2].print_out()

# MO coefficients
C = ciwfn.Ca().to_array()

# overlap matrix
S = ciwfn.S().to_array()

print("Overlap test:")
n = S.shape[0]
print(np.mean(np.abs(C.T @ S @ C - np.eye(n))))

# z-direction AO dipole moment matrix
AOdipmat = AOdip[2].to_array()
MOdipmat = C.T @ AOdipmat @ C

# set CI size
cisize = 4

# grab the Hamiltonian
test = psi4.core.variables()
ham = []
for j in range(cisize):
    ham.append( test['CI ROOT '+str(j)+' TOTAL ENERGY'] )
ham = np.array(ham)

print("Diagonalized Hamiltonian:")
print(ham)

# initialize CI dipole moment matrix in z direction
CIdimatzMO = np.zeros((cisize,cisize))
CIdimatzAO = np.zeros((cisize,cisize))
# initialize B tensor
Bten = np.zeros((cisize, cisize, n, n))
for i in range(cisize):
    for j in range(cisize):
        ciop_dm = ciwfn.get_opdm(i,j,'SUM',True)
        # store this in Bten
        Bten[i,j,:,:] = ciop_dm.to_array()
        # density matrix: change basis from MO to AO
        dmAO = C @ ciop_dm.to_array() @ C.T
        # compute this particular density matrix element
        CIdimatzMO[i, j] = np.trace( ciop_dm.to_array() @ MOdipmat )
        CIdimatzAO[i, j] = np.trace( dmAO @ AOdipmat )

print("Difference between CI basis dipole moment matrices computed via AO vs MO:")
print(np.mean(np.abs(CIdimatzMO - CIdimatzAO)))

CIdimatfile = np.load('../logfiles/casscf22_s2_h2_sto-3g_CI_dimat.npz')
print("Difference between new and old CI basis dipole moment matrices:")
print(np.mean(np.abs(CIdimatfile - CIdimatzMO)))

print("Difference between **diagonals** of new and old CI basis dipole moment matrices:")
print(np.mean(np.abs(np.diag(CIdimatfile - CIdimatzMO))))

# reshape OPDMs into B tensor

np.savez('./fci_h2_sto-3g.npz',C=C,S=S,AOdipmat=AOdipmat,CIdimatz=CIdimatzMO,Bten=Bten,ham=ham)

# for debugging purposes:
# Bmat = Bten.reshape((cisize**2, n**2))
# Bmat[np.abs(Bmat) < 1e-14] = 0.0
# print(Bmat)




--------------------------------------------------------------------------

  Memory set to 953.674 MiB by Python driver.
   => Libint2 <=

    Primary   basis highest AM E, G, H:  6, 6, 3
    Auxiliary basis highest AM E, G, H:  7, 7, 4
    Onebody   basis highest AM E, G, H:  -, -, -
    Solid Harmonics ordering:            Gaussian

*** tstart() called on gnode010.cluster
*** at Sat Sep 13 17:01:20 2025

   => Loading Basis Set <=

    Name: STO-3G
    Role: ORBITAL
    Keyword: BASIS
    atoms 1-2 entry H          line    19 file /home/hbhat/psi4conda/share/psi4/basis/sto-3g.gbs 


         ---------------------------------------------------------
                                   SCF
               by Justin Turney, Rob Parrish, Andy Simmonett
                          and Daniel G. A. Smith
                              RHF Reference
                        1 Threads,    953 MiB Core
         ---------------------------------------------------------

  ==> Geometry <==

    Molecular point group: c1
    Full point group: D_inf_h

    Geometry (in Angstrom), charge = 0, multiplicity = 1:

       Center              X                  Y                   Z               Mass       
    ------------   -----------------  -----------------  -----------------  -----------------
         H            0.000000000000     0.000000000000    -0.370000000000     1.007825032230
         H            0.000000000000     0.000000000000     0.370000000000     1.007825032230

  Running in c1 symmetry.

  Rotational constants: A = ************  B =     61.09110  C =     61.09110 [cm^-1]
  Rotational constants: A = ************  B = 1831464.96157  C = 1831464.96157 [MHz]
  Nuclear repulsion =    0.715104338743243

  Charge       = 0
  Multiplicity = 1
  Electrons    = 2
  Nalpha       = 1
  Nbeta        = 1

  ==> Algorithm <==

  SCF Algorithm Type is PK.
  DIIS enabled.
  MOM disabled.
  Fractional occupation disabled.
  Guess Type is SAD.
  Energy threshold   = 1.00e-10
  Density threshold  = 1.00e-10
  Integral threshold = 1.00e-12

  ==> Primary Basis <==

  -AO BASIS SET INFORMATION:
    Name                   = STO-3G
    Blend                  = STO-3G
    Total number of shells = 2
    Number of primitives   = 6
    Number of AO           = 2
    Number of SO           = 2
    Maximum AM             = 0
    Spherical Harmonics    = TRUE

  -Contraction Scheme:
    Atom   Type   All Primitives // Shells:
   ------ ------ --------------------------
       1     H     3s // 1s 
       2     H     3s // 1s 

  ==> Integral Setup <==

  Using in-core PK algorithm.
   Calculation information:
      Number of atoms:                   2
      Number of AO shells:               2
      Number of primitives:              6
      Number of atomic orbitals:         2
      Number of basis functions:         2

      Integral cutoff                 1.00e-12
      Number of threads:                 1

  Performing in-core PK
  Using 12 doubles for integral storage.
  We computed 6 shell quartets total.
  Whereas there are 6 unique shell quartets.

  ==> DiskJK: Disk-Based J/K Matrices <==

    J tasked:                  Yes
    K tasked:                  Yes
    wK tasked:                  No
    Memory [MiB]:              715
    Schwarz Cutoff:          1E-12

    OpenMP threads:              1

  Minimum eigenvalue in the overlap matrix is 3.4012687846E-01.
  Reciprocal condition number of the overlap matrix is 2.0491137186E-01.
    Using symmetric orthogonalization.

  ==> Pre-Iterations <==

  SCF Guess: Superposition of Atomic Densities via on-the-fly atomic UHF (no occupation information).

   -------------------------
    Irrep   Nso     Nmo    
   -------------------------
     A          2       2 
   -------------------------
    Total       2       2
   -------------------------

  ==> Iterations <==

                        Total Energy        Delta E     RMS |[F,P]|

   @RHF iter SAD:    -0.71831199467399   -7.18312e-01   0.00000e+00 
   @RHF iter   1:    -1.11675930737816   -3.98447e-01   5.22405e-17 DIIS
   @RHF iter   2:    -1.11675930737816    0.00000e+00   5.22405e-17 DIIS
  Energy and wave function converged.


  ==> Post-Iterations <==

    Orbital Energies [Eh]
    ---------------------

    Doubly Occupied:                                                      

       1A     -0.578554  

    Virtual:                                                              

       2A      0.671143  

    Final Occupation by Irrep:
              A 
    DOCC [     1 ]
    NA   [     1 ]
    NB   [     1 ]

  @RHF Final Energy:    -1.11675930737816

   => Energetics <=

    Nuclear Repulsion Energy =              0.7151043387432432
    One-Electron Energy =                  -2.5066195728691314
    Two-Electron Energy =                   0.6747559267477314
    Total Energy =                         -1.1167593073781568

Computation Completed


Properties will be evaluated at   0.000000,   0.000000,   0.000000 [a0]

Properties computed using the SCF density matrix


 Multipole Moments:

 ------------------------------------------------------------------------------------
     Multipole            Electronic (a.u.)      Nuclear  (a.u.)        Total (a.u.)
 ------------------------------------------------------------------------------------

 L = 1.  Multiply by 2.5417464519 to convert [e a0] to [Debye]
 Dipole X            :          0.0000000            0.0000000            0.0000000
 Dipole Y            :          0.0000000            0.0000000            0.0000000
 Dipole Z            :          0.0000000            0.0000000            0.0000000
 Magnitude           :                                                    0.0000000

 ------------------------------------------------------------------------------------

*** tstop() called on gnode010.cluster at Sat Sep 13 17:01:20 2025
Module time:
	user time   =       0.09 seconds =       0.00 minutes
	system time =       0.00 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes
Total time:
	user time   =       0.09 seconds =       0.00 minutes
	system time =       0.00 seconds =       0.00 minutes
	total time  =          0 seconds =       0.00 minutes
 MINTS: Wrapper to libmints.
   by Justin Turney

   Calculation information:
      Number of threads:                 1
      Number of atoms:                   2
      Number of AO shells:               2
      Number of SO shells:               2
      Number of primitives:              6
      Number of atomic orbitals:         2
      Number of basis functions:         2

      Number of irreps:                  1
      Integral cutoff                 1.00e-12
      Number of functions per irrep: [   2 ]

 OEINTS: Overlap, kinetic, potential, dipole, and quadrupole integrals
         stored in file 35.

      Computing two-electron integrals...done
      Computed 6 non-zero two-electron integrals.
        Stored in file 33.


         ---------------------------------------------------------
                          Configuration Interaction
                            (a 'D E T C I' module)

                 C. David Sherrill, Daniel G. A. Smith, and
                              Matt L. Leininger
         ---------------------------------------------------------

DAVIDSON update not available for OLSEN or MITRUSH iterators

   ==> Parameters <==

    EX LEVEL       =        2      H0 BLOCKSIZE  =     1000
    VAL EX LEVEL   =        0      H0 GUESS SIZE =     1000
    H0COUPLINGSIZE =        0      H0 COUPLING   =       NO
    MAXITER        =       24      NUM PRINT     =       20
    NUM ROOTS      =        4      ICORE         =        1
    PRINT LVL      =        2      FCI           =      YES
    R CONV         = 1.00e-04      MIXED         =      YES
    E CONV         = 1.00e-08      MIXED4        =      YES
    R4S            =       NO      REPL OTF      =       NO
    DIAG METHOD    =      RSP      FOLLOW ROOT   =        0
    PRECONDITIONER = DAVIDSON      UPDATE        = OLSEN
    S              =   0.0000      Ms0           =       NO
    GUESS VECTOR   =  H0BLOCK      OPENTYPE      =     NONE
    COLLAPSE SIZE  =        1      HD AVG        = EVANGELISTI
    MAX NUM VECS   =        0      REF SYM       =     AUTO
    IOPEN        =       NO

    EX ALLOW       =  1  1 
    STATE AVERAGE  =  0(1.00) 

   ==> CI Orbital and Space information <==

   ------------------------------------
               Space    Total     A
   ------------------------------------
                 Nso        2     2
                 Nmo        2     2
               Ndocc        1     1
               Nsocc        0     0
   ------------------------------------
              CI Spaces
   ------------------------------------
        Dropped DOCC        0     0
              Active        2     2
        Dropped UOCC        0     0
   ------------------------------------

   ==> Setting up CI strings <==

    There are 2 alpha and 2 beta strings
    The CI space requires 4 (4.00E+00) determinants and 1 blocks
    Total H0block size (including coupling): 4

   ==> Transforming CI integrals <==

	Presorting SO-basis two-electron integrals.
	Sorting File: SO Ints (nn|nn) nbuckets = 1
	Constructing frozen core operators
	Starting first half-transformation.
	h = 0; memfree         = 124999992
	h = 0; rows_per_bucket = 3
	h = 0; rows_left       = 0
	h = 0; nbuckets        = 1
	Sorting half-transformed integrals.
	First half integral transformation complete.
	Starting second half-transformation.
	h = 0; memfree         = 124999992
	h = 0; rows_per_bucket = 3
	h = 0; rows_left       = 0
	h = 0; nbuckets        = 1
	Two-electron integral transformation complete.

   ==> Starting CI iterations <==

    Exact Diagonalization Algorithm

   ==> Energetics <==

    SCF energy =           -1.116759307378157
    Total CI energy =      -1.137283834485513

   ==> DETCI root 0 information <==

    DETCI Root 0 energy =    -1.137283834485513

   The 4 most important determinants:

    *   1    0.993647  (    0,    0)  1AX 
    *   2   -0.112544  (    1,    1)  2AX 


   ==> DETCI root 1 information <==

    DETCI Root 1 energy =    -0.530773357428456

   The 4 most important determinants:

    *   1    0.707107  (    0,    1)  1AA 2AB 
    *   2   -0.707107  (    1,    0)  1AB 2AA 


   ==> DETCI root 2 information <==

    DETCI Root 2 energy =    -0.168352433358942

   The 4 most important determinants:

    *   1    0.707107  (    1,    0)  1AB 2AA 
    *   2    0.707107  (    0,    1)  1AA 2AB 


   ==> DETCI root 3 information <==

    DETCI Root 3 energy =     0.483142672291850

   The 4 most important determinants:

    *   1    0.993647  (    1,    1)  2AX 
    *   2    0.112544  (    0,    0)  1AX 

		 "A good bug is a dead bug" 

			 - Starship Troopers

		 "I didn't write FORTRAN.  That's the problem."

			 - Edward Valeev


Properties will be evaluated at   0.000000,   0.000000,   0.000000 [a0]

Properties computed using the DETCI density matrix


 Multipole Moments:

 ------------------------------------------------------------------------------------
     Multipole            Electronic (a.u.)      Nuclear  (a.u.)        Total (a.u.)
 ------------------------------------------------------------------------------------

 L = 1.  Multiply by 2.5417464519 to convert [e a0] to [Debye]
 Dipole X            :          0.0000000            0.0000000            0.0000000
 Dipole Y            :          0.0000000            0.0000000            0.0000000
 Dipole Z            :          0.0000000            0.0000000            0.0000000
 Magnitude           :                                                    0.0000000

 ------------------------------------------------------------------------------------


Properties will be evaluated at   0.000000,   0.000000,   0.000000 [a0]

Properties computed using the CI density matrix


 Multipole Moments:

 ------------------------------------------------------------------------------------
     Multipole            Electronic (a.u.)      Nuclear  (a.u.)        Total (a.u.)
 ------------------------------------------------------------------------------------

 L = 1.  Multiply by 2.5417464519 to convert [e a0] to [Debye]
 Dipole X            :          0.0000000            0.0000000            0.0000000
 Dipole Y            :          0.0000000            0.0000000            0.0000000
 Dipole Z            :          0.0000000            0.0000000            0.0000000
 Magnitude           :                                                    0.0000000

 ------------------------------------------------------------------------------------

   ===> CI properties for all CI roots <=== 


Properties computed using the CI ROOT 0 density matrix


 Multipole Moments:

 ------------------------------------------------------------------------------------
     Multipole            Electronic (a.u.)      Nuclear  (a.u.)        Total (a.u.)
 ------------------------------------------------------------------------------------

 L = 1.  Multiply by 2.5417464519 to convert [e a0] to [Debye]
 Dipole X            :          0.0000000            0.0000000            0.0000000
 Dipole Y            :          0.0000000            0.0000000            0.0000000
 Dipole Z            :          0.0000000            0.0000000            0.0000000
 Magnitude           :                                                    0.0000000

 ------------------------------------------------------------------------------------

Properties computed using the CI ROOT 1 density matrix


 Multipole Moments:

 ------------------------------------------------------------------------------------
     Multipole            Electronic (a.u.)      Nuclear  (a.u.)        Total (a.u.)
 ------------------------------------------------------------------------------------

 L = 1.  Multiply by 2.5417464519 to convert [e a0] to [Debye]
 Dipole X            :          0.0000000            0.0000000            0.0000000
 Dipole Y            :          0.0000000            0.0000000            0.0000000
 Dipole Z            :         -0.0000000            0.0000000           -0.0000000
 Magnitude           :                                                    0.0000000

 ------------------------------------------------------------------------------------

Properties computed using the CI ROOT 2 density matrix


 Multipole Moments:

 ------------------------------------------------------------------------------------
     Multipole            Electronic (a.u.)      Nuclear  (a.u.)        Total (a.u.)
 ------------------------------------------------------------------------------------

 L = 1.  Multiply by 2.5417464519 to convert [e a0] to [Debye]
 Dipole X            :          0.0000000            0.0000000            0.0000000
 Dipole Y            :          0.0000000            0.0000000            0.0000000
 Dipole Z            :          0.0000000            0.0000000            0.0000000
 Magnitude           :                                                    0.0000000

 ------------------------------------------------------------------------------------

Properties computed using the CI ROOT 3 density matrix


 Multipole Moments:

 ------------------------------------------------------------------------------------
     Multipole            Electronic (a.u.)      Nuclear  (a.u.)        Total (a.u.)
 ------------------------------------------------------------------------------------

 L = 1.  Multiply by 2.5417464519 to convert [e a0] to [Debye]
 Dipole X            :          0.0000000            0.0000000            0.0000000
 Dipole Y            :          0.0000000            0.0000000            0.0000000
 Dipole Z            :         -0.0000000            0.0000000           -0.0000000
 Magnitude           :                                                    0.0000000

 ------------------------------------------------------------------------------------

   ===> CI properties for all CI transition density matrices <=== 


Properties computed using the CI ROOT 0 -> ROOT 1 density matrix


Transition Multipole Moments:

 ------------------------------------------------------------------------------------
     Multipole            Electronic (a.u.)      Nuclear  (a.u.)        Total (a.u.)
 ------------------------------------------------------------------------------------

 L = 1.  Multiply by 2.5417464519 to convert [e a0] to [Debye]
 Dipole X            :          0.0000000            0.0000000            0.0000000
 Dipole Y            :          0.0000000            0.0000000            0.0000000
 Dipole Z            :         -1.4557528            0.0000000           -1.4557528
 Magnitude           :                                                    1.4557528

 ------------------------------------------------------------------------------------

Properties computed using the CI ROOT 0 -> ROOT 2 density matrix


Transition Multipole Moments:

 ------------------------------------------------------------------------------------
     Multipole            Electronic (a.u.)      Nuclear  (a.u.)        Total (a.u.)
 ------------------------------------------------------------------------------------

 L = 1.  Multiply by 2.5417464519 to convert [e a0] to [Debye]
 Dipole X            :          0.0000000            0.0000000            0.0000000
 Dipole Y            :          0.0000000            0.0000000            0.0000000
 Dipole Z            :          1.1595361            0.0000000            1.1595361
 Magnitude           :                                                    1.1595361

 ------------------------------------------------------------------------------------

Properties computed using the CI ROOT 0 -> ROOT 3 density matrix


Transition Multipole Moments:

 ------------------------------------------------------------------------------------
     Multipole            Electronic (a.u.)      Nuclear  (a.u.)        Total (a.u.)
 ------------------------------------------------------------------------------------

 L = 1.  Multiply by 2.5417464519 to convert [e a0] to [Debye]
 Dipole X            :          0.0000000            0.0000000            0.0000000
 Dipole Y            :          0.0000000            0.0000000            0.0000000
 Dipole Z            :         -0.0000000            0.0000000           -0.0000000
 Magnitude           :                                                    0.0000000

 ------------------------------------------------------------------------------------
  ## AO Mux (Symmetry 0) ##
  Irrep: 1 Size: 2 x 2

                 1                   2

    1     0.00000000000000     0.00000000000000
    2     0.00000000000000     0.00000000000000



  ## AO Muy (Symmetry 0) ##
  Irrep: 1 Size: 2 x 2

                 1                   2

    1     0.00000000000000     0.00000000000000
    2     0.00000000000000     0.00000000000000



  ## AO Muz (Symmetry 0) ##
  Irrep: 1 Size: 2 x 2

                 1                   2

    1     0.69919866641940     0.00000000000000
    2     0.00000000000000    -0.69919866641940




    Psi4 stopped on: Saturday, 13 September 2025 05:01PM
    Psi4 wall time for execution: 0:00:00.21

*** Psi4 exiting successfully. Buy a developer a beer!
